# 使用真实数据完成课程设计说明

## 📋 数据准备

您已经提供了以下真实数据集：

1. **香水.xlsx** - 香水产品信息（1009条记录）
2. **申请客户信息.xlsx** - 客户基本信息（10000条记录）
3. **消费历史记录.xlsx** - 消费记录（5954条记录）
4. **客户信用记录.xlsx** - 客户信用信息（5954条记录）
5. **拖欠历史记录.xlsx** - 拖欠记录（303条记录）

## 🚀 快速开始

### 步骤1: 安装依赖

```bash
cd perfume_sales_analysis
pip install -r requirements.txt
```

### 步骤2: 运行完整分析流程

```bash
python main_real_data.py
```

程序将自动执行以下步骤：
1. ✅ 真实数据预处理与转换
2. ✅ 数据清洗与特征工程（RFM分析）
3. ✅ 数据仓库构建（星形模型）
4. ✅ 客户细分分析（K-Means聚类）
5. ✅ 关联规则挖掘（Apriori算法）
6. ✅ 综合数据可视化

## 📊 数据处理逻辑

### 数据转换说明

由于原始数据是信贷业务数据，我们进行了以下转换以适配香水销售分析场景：

#### 1. 客户数据
- **来源**: 客户信用记录.xlsx
- **转换**:
  - 客户号 → 客户ID (格式: C123456789)
  - 年龄_连续 → 年龄
  - 户籍 → 城市
  - 信用等级 → 会员等级
  - 生成随机注册日期（2022-2024年）

#### 2. 产品数据
- **来源**: 香水.xlsx
- **处理**:
  - 筛选有效价格产品（价格>0且<3000）
  - 随机选择50个产品作为主要销售产品
  - 提取品牌信息
  - 使用性别字段作为分类（男士/女士/中性香水）

#### 3. 交易数据
- **来源**: 消费历史记录.xlsx
- **生成逻辑**:
  - 根据"日均次数"生成交易频率
  - 基于产品价格和消费金额范围生成订单金额
  - 随机分配交易日期（2023-2024年）
  - 计算利润（利润率30-50%）

#### 4. 营销活动
- **生成**: 创建8个营销活动
  - 春季促销、618大促、七夕、双十一等
  - 折扣范围：8%-25%
  - 70%的活动期间交易参与促销

## 📈 分析输出

### 数据文件
```
data/
├── raw/                      # 转换后的原始数据
│   ├── customers.csv
│   ├── products.csv
│   ├── sales_transactions.csv
│   └── marketing_campaigns.csv
├── processed/                # 预处理数据
│   ├── customer_features.csv
│   ├── rfm_analysis.csv
│   └── ...
└── warehouse/                # 数据仓库
    ├── dim_customer.csv
    ├── dim_product.csv
    ├── dim_time.csv
    ├── fact_sales.csv
    └── ...
```

### 分析结果
```
output/
├── customer_segmentation_results.csv    # 客户细分结果
├── cluster_summary.csv                  # 聚类摘要
├── frequent_itemsets.csv                # 频繁项集
└── association_rules.csv                # 关联规则
```

### 可视化图表
```
figures/
├── optimal_k_selection.png              # K值选择
├── clustering_kmeans_visualization.png  # 聚类可视化
├── cluster_heatmap.png                  # 客户特征热力图
├── cluster_feature_comparison.png       # 特征对比
├── association_rules_analysis.png       # 关联规则分析
├── frequent_itemsets_distribution.png   # 频繁项集分布
├── sales_overview.png                   # 销售概览
├── customer_analysis.png                # 客户分析
├── product_analysis.png                 # 产品分析
├── marketing_analysis.png               # 营销分析
└── interactive_dashboard.html           # 交互式仪表板
```

## 🎯 完成任务书要求

### ✅ 数据采集与预处理
- [x] 数据清洗：处理缺失值、异常值
- [x] 数据转换：格式转换、类型转换
- [x] 特征工程：RFM指标、客户生命周期等

### ✅ 数据仓库构建
- [x] 星形模型设计
- [x] 客户维度表
- [x] 产品维度表
- [x] 时间维度表
- [x] 营销活动维度表
- [x] 销售事实表

### ✅ 数据挖掘分析
- [x] K-Means客户细分（识别4个客户群体）
- [x] DBSCAN聚类对比分析
- [x] Apriori关联规则挖掘
- [x] 模型评估（轮廓系数、DB指数等）

### ✅ 可视化与决策支持
- [x] 20+张专业分析图表
- [x] 交互式数据仪表板
- [x] 业务解读和营销建议
- [x] 完整的课程设计报告

## 📝 报告撰写

参考以下文件撰写课程设计报告：

1. **课程设计报告.md** - 完整的报告模板
2. **output/** - 分析结果数据
3. **figures/** - 图表素材
4. **data/warehouse/star_schema_design.txt** - 星形模型设计说明

## 💡 使用建议

### 分步执行（可选）

如果需要单独执行某个步骤，可以直接运行对应脚本：

```bash
# 步骤1: 数据预处理
python scripts/01_real_data_preprocessing.py

# 步骤2: 特征工程
python scripts/02_data_preprocessing.py

# 步骤3: 数据仓库
python scripts/03_data_warehouse.py

# 步骤4: 客户细分
python scripts/04_customer_segmentation.py

# 步骤5: 关联规则
python scripts/05_association_rules.py

# 步骤6: 可视化
python scripts/06_visualization.py
```

### 查看交互式仪表板

分析完成后，打开以下文件查看交互式可视化：
```
figures/interactive_dashboard.html
```

### 调整参数

如需调整分析参数，可编辑对应脚本：

- **K-Means聚类数**: `scripts/04_customer_segmentation.py` 第237行
- **最小支持度**: `scripts/05_association_rules.py` 第282行
- **置信度阈值**: `scripts/05_association_rules.py` 第282行

## ❓ 常见问题

### Q1: 数据量太少怎么办？
A: 已通过消费频率扩展交易记录，每个客户平均生成5-10笔交易。

### Q2: 如何解释分析结果？
A: 参考`课程设计报告.md`第7章"决策支持与结果分析"。

### Q3: 图表中文显示乱码？
A: 确保系统安装了中文字体（SimHei或Microsoft YaHei）。

### Q4: 能否使用自己的数据？
A: 可以！只需替换`数据/`目录下的Excel文件即可。

## 📞 技术支持

如遇到问题，请检查：
1. Python版本 >= 3.8
2. 所有依赖包已正确安装
3. 数据文件路径正确
4. 有足够的磁盘空间（至少500MB）

---

**祝您课程设计顺利完成！** 🎉



